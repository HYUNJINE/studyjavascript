## 1.1 서버리스 개요

서버리스는 단순하게 번역하면 서버가 없다는 의미이다.

서버리스 서비스를 이용하면 전세계 어딘가에있는 서버에서 내 코드를 실행시킨다. 서버가 없다는 것은 그냥 표현일 뿐이다. 

여기서 여러분의 서버는 보이지 않고 전혀 신경쓰지 않아도 된다는 의미로 받아들이면 된다.

서버리스 서비스는 인프라를 관리하고 주요 상세 사항을 처리한다.


서비스 시스템 형태의 간략한 설명

- 전통적인IT: 네트워크 구축부터 소프트웨어까지 전부 구축하고 개발
- laaS(Infrastructure as a Service): 하드웨어 구축을 하지 않고 , 인프라 요소를 서비스 형태로 제공, 일반적인 서버 가상화 서비스
- CaaS(Container as a Service): 컨테이너를 사용해서 애플리케이션을 배포할 환경을 제공
- PaaS(Platform as a Service): 인프라와 런타임  환경 제공
- Serverless: 애플리케이션을 실행할 수 있는 환경을 제공
- Saas(Software as a Service): 소프트웨어를 제공

서버리스는 백엔드형 서비스와 함수형 서비스로 나눈다.

## 1.2 백엔드형 서비스 (Backend as a Service)

웹이나 모바일 개발을 하면서 프론트엔드에서 모든 기능을 할수있는 경우도 있다. 하지만 사용자를 관리해야하고 그 사요앚에게 최신의 데이터를 제공하고 싶다면 백엔드개발은 필수적으로 따라올수 밖에없다. 그리고 그 백엔드 개발을 하면서 서버의 관리도 필연적으로 따라온다. 사용자가 많아지면서 서버 확장을 해야하고 보안에도 신경을 써야한다. 이런 걱정을 덜기위해 나온서비스가 BaaS이다. 대표적인 서비스가 구글의 파이어베이스이다. 파이어베이슨느 앱 개발에 필요한 기능들을 API형태로 제공해준다. 

- 실시간 데이터베이스: 온라인으로 제공되는 NoSQL DB
- 소셜 인증: 각종 소셜 계쩡으로 로그인 인증을 제공
- 클라우드 메시지: 모바일 푸시 메시지와 같은 알림으로 메시지를 보낸다.
- 저장소: 사용자의 사진과 동영상같은 컨텐츠를 저장
- 호스팅: 웹 콘텐츠 호스팅 서비스이다. 
- 원격설정: 앱 업데이트 없이 앱의 설정을 변경하고 싶을 때 사용
- 테스트랩: 일종의 AB테스트를 지원
- 중단 리포트: 앱 실행중 작동이 중단되면 어디서 중단되었는지 콜스택등을 제공

## 1.3 함수형 서비스

## 1.4 서버리스의 장점

- 운영비용의 절감: 서비스의 특성에 따라 사용자가 몰리는 시간대가 생기기 마련이다. 예를 들어서 음식 배달 서비스를 하게되면 오후 점심 시간대와 저녁 시간대 정도에 사용자가 몰리게 되고 나머지 시간대에는 사용자가 거의 없다. 이럴 경우 기존 시스템의 경우 하루종일 모든 시스템은 사용자를 받을 준비를 한다. 하지만 서버리스는 이런 걱정을 하지 않아도된다. 정확하게 요청한 횟수만큼 요금을 부과하기 때문이다. 최악의 경우이긴 하지만 서비스가 중단되거나 회사가 망했을 경우, 프로젝트를 처리하면서 매몰 비용도 발생할 수 있다. 이럴때 서버리스는 단순히 서비스 중단을 처리해주는 것으로 끝나게된다.
- 자동화된 고가용성: Highly availability 이란 서버 시스템과 네트워크 프로그램 등의 시스템 중에서 오류가 발생하거나 다운되더라도 만족스러운 성능으로 운영이 지속적으로 가능한 상태를 말한다. 
- 서버 관리 불필요: 서버를 프로비저닝하거나 유지관리 필요 없다. 
- 시스템 보안의 아웃소싱: 클라우드 공급 업체에서는 운영체제 보안, 네트워킹 접근, 런타임등 모든 클라우드 서비스 운영에 필요한 모든 기술을 관리해야한다. 
- 업무에 집중

## 1.5 서버리스의 단점

- 시작 지연시간: 서버리스의 함수는 언제나 호출할 수 있지만 항상 활성화 되어있지는 않는다. 서버리스에 호출을 받게되면 해당함수가 들어있는 컨테이너가 활성화 되어있는지를 확인한다. 활성화 되어있지 않는다면 컨테이너를 활성화해준다음 해당 함수를 실행한다. 이런 컨테이너를 활성화해주는 시간을 시작 지연 시간 이라고 한다. cold start delay  시작지연시간은 함수에 사용되는 언어마다 약간씩 다르긴 하지만 대략 3~5 초간 응압이 지연되게 된다. 시작 지연시간을 없애기 위해서는 지속적인 함수 호출이 필요하다. 이를 위해서 다른 서비스또는 시스템의 힘을 빌려야하는 수고스러움이 생긴다.
- 제약조건: 서버리스는 오랜 연산이 필요한 작업이나 대기시간이 길게 필요한 작업에는 적합하지 않은 서비스이다. 서버리스는 짧은 시간 동안 입려고가 출력을 비용 효율적으로 작업하도록 설계된 서비스이다. 그리고 AWS 의 람다의 또 다른 제한 사항이다. 기본적으로 특정 리전 내의 모든 함수에서 동시 실행의 총 횟수를 1000회로 제한하게 되어있다. 이 제한사항은 설정으로 변경이 가능하다. 이런 각 서버리스 서비스마다 다른 제약조건을 사전에 숙지하지 않으면 서비스에서 낭패를 겪을 수 있다.
- 람다는 비싸다: 컴퓨팅 자원만으로 본다면 람다는 EC2에 비해 비싼 수준이다. 일반적인 서버에서 함수를 한번 실행하는 것을 가격으로 환산해서 비교한다면 매우 많이 비싼 요금이다. 하지만 람다는 이 비싼 요금을 유휴시간에는 비용을 0으로 만들 수 있고 호출된 횟수만큼의 비용을 지불할 수 있다는 특징을 갖는다. 서비스가 커지고 전세계로 서비스를 해서 유휴 시간을 줄고 비용이 커진다면 EC2로 이전하거나 단독 호스팅하는 것도 고민해야한다.
- 디버깅: 서버리스 프레임워크의 오프라인 기능 또한 비슷한 환경을 구성해서 서비스를 수행하며 제작해야한다.
- 복잡성: 람다를 구성하면서 그냥 일반 서버였으면 간단하게 시스템리소스를 사용해 구현할 작업을 복잡하게 다른 방법으로 구성해야할 때가 많다. 예를 들어 시스템에서 간혹 사용되는 스케줄러 같은 것은 람다로 구현되지 않는다. 주기적인 람다 함수 호출이 필요하다면 다른 cloud watch 의 events-schedule 로 연결하거나 다른 시스템에서 주기적으로 람다함수를 호출해야한다. 이런 식으로 기능 구현을 위해 다양한 방법으로 해결하다보면 시스템이 파편화 된다. 구성을 잘 기록하지 않으면 어디서 문제가 발생하는지 파악하기 어렵다.
- 공급업체 종속: 공급업체의 서비스가 업데이트되면서 개발된 소프트웨어를 맞춰 업데이트해야할 경우도 생긴다. 

## 1.6 플랫폼별 서버리스 서비스
유즈케이스와 조직 내의 지식을 기반으로 가장 적합한 서버리스 플랫폼을 선택하는 것.

AWS 람다: 람다는 이벤트 중심의 접근 방식을 따르며 이벤트가 발생하면 필요한 기능을 수행함은 물론이고 트래픽 증가에 따라서 자동으로 스케일을 늘릴 수 있다.트래픽이 줄어들면 늘어났던 스케일이 자동으로 줄일수도 있다. 람사함수는 HTTP요청에 대한 응답, AWS S3 버킷의 데이터 변경 또는 AWS DynamoDB 테이블 변경과 같은 이벤트에 대한 응답으로 실행된다. 이런 이벤트 트리거방법을 다양하게 이용해서 여러가지 형태의 서비스를 구성할 수 있다. 람다는 CPU, 메모리, 저장공간, 네트워크, 시스템 구성과 같은 부분을 알아서 처리하므로 개발자는 코딩에만 집중해서 개발하면된다. 또한 패치, 로깅및 기능모니터링도자동으로 관리해준다. 람다는 개발자가 제공되는 구서엥 맞춰 개발해서 코드를 넣어주면 제공된 구성에따라 시작되는 컨테이너에서 호출된다. AWS 람다에서 지원하는 언어에는 nodejs, java,c#, go, python, ruby등이 있다. 

람다는 월별 1백만 회 무료요청과 월별 40만 GB-초 컴퓨팅 시간을 무료로 제공하며 1백만 회당 0.2USD에 매 GB-초 사용시 0.000001667가 부가된다. 추가로 S3와 다이나모디비등을 사용할 때 데이터 전송 요금이 부과된다. 람다 함수에서 실행한 리전외부에 사용되는 송신, 수신에 대해EC2 데이터 전송 요금이부과돤다.람다의 실행비용과 더불어 데이터 전송 요금도 신경써서 시스템을 설계하거나 서비스를 선택해야한다.

