## 4.2 목표

문서관리시스템 -> 기존 환자 정보 파일을 읽어 색인을 추가하고 검색할 수 있는 형태의 정보로 변환해야한다. 

- 리포트: 환자의 수술과 관련된 상담 내용을 기록한 본문이다.
- 우편물: 특정 주소로 발송되는 텍스트 문서이다.
- 치아와 잇몸 엑스레이 사진을 저장한다. 용량이 크다.

### 4.4.1 임포터

### 4.4.2 Document 클래스

각 문서는 검색할 수 있는 다양한 속성을 포함한다. 문서의 종류에 따라 포함하는 속성이 달라진다. 가장 간단한 방법은 Map<STring, String > 으로 속성 이름을 값과 매핑하는 방법이다. 한 문서를 모델링하고 새 도메인크랠스를 소개하는 것은 식은 죽 먹기처럼 간단히 결정할 수 있는 일이아니라 으용ㅇ프로그램의 유지보수성과 가독성을 고려해야하는 일이ㅏㄷ. 


우선 응용프로그램의 컴포넌트 이름을 구체적으로 지어야함으니 중요성은 아무리 강조해도 지나치지 않다. 동료나 고객과 대화할 때 소프트웨어의 다양한 기능을 어떤 공통언어로 약속한다. 이때 사용한 어휘를 코드로 매핑하면 코드의 어떤 부분을 바꿔야하는지 쉽게 알 수 있다. 이를 발견성이라고한다.유비쿼터스 언어는 에릭 에번스가 집필한 도메인 주도 설계에서 처음등장한다 .유비쿼터스 언어란 개발자와 사용자가 모두가 사용할 수 있도록 설계 , 공유된 공통 언어를 말한다. 

Document 패키지 영역으로 제한된 생성자를 갖고 있다. 보통 자바클래스는public 을 사용하지만 그러면 프로젝트의 어디에서나 그 형식의 객체를 만들수 있는 문제가 생긴다. 오직 문서 관리 시스템에서만 Document 객체를 만들수 있어야하므로 패키지 영역으로 생성자를 제한하고 문서 관리 시스템이 위치한 패키지에서만 접근권한을 준다.

### 4.4.3  Document 속성 및 계층
흔히 속성값을 복잡하게 사용할 때는 다양한 속성 형식으로 파싱하는 것이 좋다. 예를 들어 특정 반경 내의 주소를 찾거나 특정 크기 이하의 높이와 너비를 가진 이미지를 검색할 때 String 보다 강한 형식을 가진 속성이 훨씬 도움이된다. 문자열보다는 정숫값의 너비를 더쉽게 비교할 수 있기 때문이다. 문서의 각 서브 클래스가 전용 필드를 갖지 않도록 모든 알려진 속성을 범용으로 설계했다 또한 각 문서는 자신과 관련된 동작을 거의포함하지 않는 다. 클래스 계층으로 인한 이득이 없다면 계층을 추가할 필요가없다. 좋은 의도를 가진 확장성, 반드시 필요한 기능보다는 있으면 좋은 기능의 코드를 추가하다보면 설계가 얼룩지고 복잡해진다.

### 4.4.4. 임포터 구현과 등록


## 4.5 리스코프 치환 원칙 

하위 형식에서 선행조건을 더할 수 없음: 선행 조건은 어떤 코드가 동작하는 조건을 결정한다. 우리는 구현한 코드가 어떻게든 실행될것이라고 가정할 수는 없다. LSP란 부모가 지정한 것보다 더 많은 선행조건을 요구할 수 없음을 의미한다. 예를 들어 부모가 문서크기를 제한하지 않았다면 여러분은 문서의 크기가 100KB 보다 작아야한다고 요구할 수 없다.

하위 형식에서 후행 조건을 약화시킬 수 없음: 첫번째 규칙하고 비슷해서 헷갈릴 수 있다. 후행조건은 어떤 코드를 실행한 다음에 만족해야하는 규칙이다. 

슈퍼형식의 불변자는 하위형식에서 보존됨: 불변자란 밀물과 썰물처럼 항상 변하지 않는 어떤것을 가리킨다. 상속관계의 부모와 자식 클래스가 있을 때, 부모 클래스에서 유지되는 모든 불변자는 자식 
클래스에서도 유지되어야한다.

히스토리 규칙: LSP에서 가장 이해하기 어려운 개념중 하나다. 기본적으로 자식 클래스는 부모가 허용하지 않는 상태 변화를 허용하지 않아야한다. 

## 4.6 대안

문제를 해결하려는 도메인에 상태와 많은 동작이 관련되어있어서 강력한 is a 관계를 모델링해야하는 상황이라면 클래스 기반의 상속이 적절하다. 

### 4.6.2 영역, 캡슐화 선택하기.

같은 패키지 안의 클래스만 패키지 영역의 클래스를 보거나 접근할 수 있으며, 패키지 밖에서는 보거나 접근 불가.

패키지가 기본 영역이지만 실제 소프트웨어를 개발할 때는 패키지 영역보다 공개영역을 더많이 사용. 시간이 지나면서 응용프로그램에 다른 기법을 적용하는 것이 더 바람직할 수도있다.


