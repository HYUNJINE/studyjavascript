# 도커란?


도커는 리눅스 컨테이너에 여러 기능을 추가함으로써 애플리케이션을 컨테이너로서 좀더 쉽게 사용할 수 있게 만들어진 오픈소스 프로젝트이다. 도커엔진은 컨테이너를 생성하고 관리하는 주체로서 이 자체로도 컨테이너를 제어할 수 있고 다양한 기능을 제공하는 도커의 주 프로젝트이다.

## 1.1 가상머신과 도커 컨테이너

기존의 가상화 기술은 하이퍼바이저를 이용해 여러개의 운영체제를 하나의 호스트에서 생성해 사용하는 방식이었다. 여러개의 운영체제는 가상머신이라는 단위로 구별되고 각 가상머신에는 우분투 centos등의 운영체게 설치되어있다.하이퍼 바이저에의해 생성되고 관리되는 운영체제는 게스트 운영체제라고하며 각 게스트운영체제는 다른 게스트 운영체제와는 완전히 독립된 공간과 시스템자원을 할당받아 사용한다. 그러나 각종 시스템자원을 가상화하고 독립된 공간을 생성하는 작업은 하이퍼바이저를 반드시 거치기 때문에 일반 호스트에 비해 성능의 손실이 발생한다. 그뿐만아니라 가상머신은 게스트 운영체제를 사용하기 위한 라이브러리 커널등을 전부 포함하기 때문에 가상머신을 배포하기위한 이미지로 만들었을 때 이미지의 크기 또한 커진다. 즉 가상머신은 완벽한 운영체제를 생성할 수 있다는 장점은 있지만일반 호스트에 비해 성능 손실이 있으며, 수기가바이트에 다라는 이미지를 애플리케이션으로 배포하기는 부담스럽다는 단점이있다.

이에비해 도커 컨테이너는 가상화된 공간을 생성하기 위해 리눅스의 자체 기능인 chroot, 네임스페이스 , cgroup등을 사용함으로써 프로세스 단위의 격리환경을 만들기 때문에 성능 손실이 거의없다. 컨테이너에 필요한 커널은 호스트의 커널을 공유해서 사용하고, 컨테이너 안에는 애플리케이션을 구동하는데 필요한 라이브러리 및 실행 파일만 존재하기 때문에 컨테이너를 이미지로 만들었을 때 이미지의 용량또한 가상 머신에 비해 대폭 줄어든다. 따라서 컨테이너를 이미지로 만들어 배포하는 시간이 가상머신에 비해 빠르며, 가상화된 공간을 사용할 때 성능 손실이 거의 없다는 장점이있다.

## 1.2 도커 엔진 설치
도커는 다양한 운영체제에서 사용할 수 있다. 도커는 리눅스 컨테이너를 제어하는 API를 Go언어로 구현한 libcontainer를 사용하기 때문에 대부분의 리눅스 운영체제에서 사용할 수 있다. 도커를 사용할  때 쓰는 대표적인 리눅스 운영체제로는coreos, centos, 우분투등이있다. 


`docker info` 도커가 정상적으로 동작하는지 확인하려면 docker info 를 입력한다.
도커 툴박스는 pc에 리눅스 가상 머신을 생성한뒤 도커를 설치하므로 가상네트워크가 2개 생성되어 내부 ip를 가진 가상머신안에 natip를 할당받은 도커 컨테이너가 생성되므로 외부에서 컨테이너에 접근하기 위해서는 2중포트 포워딩이 필요하다. 첫번째는 pc와 가상머신간의 포트포워딩이고 두번째는 가상머신과 컨테이너사이의 포트 포워딩인데 후자는 도커에서 컨테이너를 생성할 때 쉽게 설정가능하다. 그렇기 때문에 호스트 pc의 웹브라우저 등으로 컨테이너에 접근하기는 쉽지만 외부에서 컨테이너에 접근하기 위해서는 호스트와 가상 머신 사이의 포트 포워딩이 별도로 필요하다. 
docker for windows , docker for mac 은 가상머신을 생성하지 않고 자체 가상화 기술로 리눅스 환경을 만들어 컨테이너를 생성한다. 따라서 도커에서 컨테이너를 생성할 때는 포트 포워딩을 설정하는 것만으로 외부에서 컨테이너에 접근할 수 있다.




